<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Repository File Tree</title>
  <style>
    body {
      background-color: #1e1e1e;
      color: #d4d4d4;
      font-family: Consolas, "Courier New", monospace;
      padding: 20px;
    }
    h1 {
      color: #9cdcfe;
    }
    ul {
      list-style-type: none;
      padding-left: 20px;
    }
    li {
      margin: 4px 0;
      line-height: 1.4;
    }
    li:hover {
      background-color: #333;
    }
  </style>
</head>
<body>
  <h1>Repository File Tree</h1>
  <div id="file-tree">Loading file tree...</div>
  
  <script>
    // Dynamic icon mapping for file types (over 100 file types)
    const fileTypeIcons = {
      "html": "ðŸŒ",
      "htm": "ðŸŒ",
      "css": "ðŸŽ¨",
      "js": "ðŸŸ¨",
      "jsx": "âš›ï¸",
      "ts": "ðŸ”·",
      "tsx": "âš›ï¸",
      "json": "ðŸ”§",
      "xml": "ðŸ“",
      "md": "ðŸ“",
      "py": "ðŸ",
      "rb": "ðŸ’Ž",
      "php": "ðŸ˜",
      "java": "â˜•",
      "c": "ðŸ”µ",
      "cpp": "ðŸŸ¦",
      "cs": "ðŸ’»",
      "go": "ðŸ¹",
      "rs": "ðŸ¦€",
      "swift": "ðŸŽ",
      "kt": "ðŸ…º",
      "kts": "ðŸ…º",
      "sh": "ðŸš",
      "bat": "âš™ï¸",
      "ps1": "âš¡",
      "pl": "ðŸª",
      "sql": "ðŸ—„ï¸",
      "yml": "ðŸ”§",
      "yaml": "ðŸ”§",
      "ini": "âš™ï¸",
      "conf": "âš™ï¸",
      "log": "ðŸ“„",
      "txt": "ðŸ“„",
      "rtf": "ðŸ“„",
      "doc": "ðŸ“„",
      "docx": "ðŸ“„",
      "ppt": "ðŸ“Š",
      "pptx": "ðŸ“Š",
      "xls": "ðŸ“Š",
      "xlsx": "ðŸ“Š",
      "csv": "ðŸ“ˆ",
      "tsv": "ðŸ“ˆ",
      "pdf": "ðŸ“•",
      "epub": "ðŸ“˜",
      "mdown": "ðŸ“",
      "markdown": "ðŸ“",
      "bak": "ðŸ—ƒï¸",
      "tmp": "ðŸ—ƒï¸",
      "zip": "ðŸ—œï¸",
      "rar": "ðŸ—œï¸",
      "7z": "ðŸ—œï¸",
      "tar": "ðŸ—œï¸",
      "gz": "ðŸ—œï¸",
      "iso": "ðŸ—œï¸",
      "dmg": "ðŸ–¥ï¸",
      "exe": "ðŸ–¥ï¸",
      "msi": "ðŸ–¥ï¸",
      "apk": "ðŸ“±",
      "jar": "â˜•",
      "war": "â˜•",
      "class": "â˜•",
      "o": "ðŸ”¹",
      "obj": "ðŸ”¹",
      "so": "ðŸ”¹",
      "dll": "ðŸ”¹",
      "deb": "ðŸ“¦",
      "rpm": "ðŸ“¦",
      "img": "ðŸ–¼ï¸",
      "ico": "ðŸ–¼ï¸",
      "png": "ðŸ–¼ï¸",
      "jpg": "ðŸ–¼ï¸",
      "jpeg": "ðŸ–¼ï¸",
      "gif": "ðŸ–¼ï¸",
      "bmp": "ðŸ–¼ï¸",
      "tiff": "ðŸ–¼ï¸",
      "svg": "ðŸ–¼ï¸",
      "mp3": "ðŸŽµ",
      "wav": "ðŸŽµ",
      "flac": "ðŸŽµ",
      "ogg": "ðŸŽµ",
      "aac": "ðŸŽµ",
      "wma": "ðŸŽµ",
      "mp4": "ðŸŽ¥",
      "mkv": "ðŸŽ¥",
      "avi": "ðŸŽ¥",
      "mov": "ðŸŽ¥",
      "wmv": "ðŸŽ¥",
      "flv": "ðŸŽ¥",
      "webm": "ðŸŽ¥",
      "m4v": "ðŸŽ¥",
      "3gp": "ðŸŽ¥",
      "3g2": "ðŸŽ¥",
      "docm": "ðŸ“„",
      "dot": "ðŸ“„",
      "xlt": "ðŸ“Š",
      "xla": "ðŸ“Š",
      "pps": "ðŸ“Š",
      "key": "ðŸ“Š",
      "numbers": "ðŸ“Š",
      "pages": "ðŸ“„",
      "cxx": "ðŸ”µ",
      "h": "ðŸ”µ",
      "hpp": "ðŸ”µ",
      "ino": "ðŸ”µ",
      "sln": "ðŸ› ï¸",
      "vb": "ðŸ“„",
      "vbs": "ðŸ“„",
      "scala": "ðŸ“œ",
      "r": "ðŸ“Š",
      "R": "ðŸ“Š",
      "jl": "ðŸ¦€",
      "m": "ðŸ“",
      "mm": "ðŸ“",
      "dart": "ðŸŽ¯",
      "coffee": "â˜•",
      "lock": "ðŸ”’",
      "pem": "ðŸ”’",
      "crt": "ðŸ”’",
      "csr": "ðŸ”’",
      "p12": "ðŸ”’",
      "pfx": "ðŸ”’"
    };

    // Replace these with your GitHub username and repository name.
    const owner = 'ctforion';
    const repo = 'ctforion.github.io';
    const branch = 'main'; // Change to 'master' if applicable

    // GitHub API URL to get the repository tree recursively.
    const apiUrl = `https://api.github.com/repos/${owner}/${repo}/git/trees/${branch}?recursive=1`;

    // Fetch the repository tree from GitHub
    fetch(apiUrl)
      .then(response => response.json())
      .then(data => {
        if (data.tree) {
          const treeData = buildTree(data.tree);
          const treeHTML = renderTree(treeData);
          document.getElementById('file-tree').innerHTML = treeHTML;
        } else {
          document.getElementById('file-tree').innerText = "Error loading repository tree.";
        }
      })
      .catch(error => {
        console.error("Error fetching repository tree:", error);
        document.getElementById('file-tree').innerText = "Error loading repository tree.";
      });

    // Build a nested tree structure from the flat list provided by GitHub API
    function buildTree(list) {
      const root = {};
      list.forEach(item => {
        const parts = item.path.split('/');
        let current = root;
        parts.forEach((part, index) => {
          if (!current[part]) {
            // Mark leaf nodes with the actual type ('blob' for files, 'tree' for directories)
            current[part] = { __meta__: { type: index === parts.length - 1 ? item.type : 'tree' } };
          }
          current = current[part];
        });
      });
      return root;
    }

    // Recursively render the tree structure as HTML nested lists with dynamic icons
    function renderTree(tree) {
      let html = '<ul>';
      for (const key in tree) {
        if (key === '__meta__') continue;
        const meta = tree[key].__meta__;
        let icon = "ðŸ“"; // Default icon for directories
        if (meta.type === 'blob') {
          // Determine file extension and get matching icon
          const parts = key.split('.');
          const ext = parts.length > 1 ? parts.pop().toLowerCase() : '';
          icon = fileTypeIcons[ext] || "ðŸ“„";
        }
        html += `<li>${icon} ${key}`;
        // Recursively render children if it's a directory
        if (meta.type === 'tree' && Object.keys(tree[key]).length > 1) {
          html += renderTree(tree[key]);
        }
        html += '</li>';
      }
      html += '</ul>';
      return html;
    }
  </script>
</body>
</html>
